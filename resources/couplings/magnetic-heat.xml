<?xml version="1.0"?>
<coupling:coupling xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="XMLCoupling ../xsd/coupling_xml.xsd"
	xmlns:coupling="XMLCoupling">

	<coupling:general id="magnetic-heat" name="Joule losses">
		<coupling:description>Heat generated by Joule losses in magnetic field</coupling:description>
		<coupling:modules>
			<coupling:source id="magnetic" />
			<coupling:target id="heat" />
		</coupling:modules>
	</coupling:general>

	<coupling:constants>
		<coupling:constant id="MU0" value="1.2566371e-06" />
	</coupling:constants>

	<coupling:volume>
		<coupling:weakforms_volume>
			<coupling:weakform_volume couplingtype="weak" sourceanalysis="harmonic"
				targetanalysis="steadystate">
                <coupling:vector_form id="coupling" i="1" j="1"
                    planar_linear="0.5 * ma_gamma * (2 * PI * f)^2 * ((source1 + source3)^2 + (source2 + source4)^2) * vval"
                    axi_linear="0.5 * ma_gamma * (2 * PI * f)^2 * ((source1 + source3)^2 + (source2 + source4)^2) * r * vval"
                    planar_newton="- 0.5 * ma_gamma * (2 * PI * f)^2 * ((source1 + source3)^2 + (source2 + source4)^2) * vval"
                    axi_newton="- 0.5 * ma_gamma * (2 * PI * f)^2 * ((source1 + source3)^2 + (source2 + source4)^2) * r * vval" />
			</coupling:weakform_volume>

<!-- TODO: has to be altered to new harmonic module with 4 fields. i: 3->5 and there will be probably two forms instead of one (i=5, j=1) AND (i=5, j=3)-->


			<coupling:weakform_volume couplingtype="hard" sourceanalysis="harmonic"
				targetanalysis="steadystate">
                <coupling:matrix_form id="coupling" i="3" j="1"
                                        planar_linear="0"
                                        axi_linear="0"
                                        planar_newton="- 0.5 * ma_gamma * (2 * PI * f) * (2 * PI * f) * 2 * upval * uval * vval"
                                        axi_newton="- 0.5 * ma_gamma * (2 * PI * f) * (2 * PI * f) * 2 * upval * uval * r * vval" />
                <coupling:matrix_form id="coupling" i="3" j="2"
                                        planar_linear="0"
                                        axi_linear="0"
                                        planar_newton="- 0.5 * ma_gamma * (2 * PI * f) * (2 * PI * f) * 2 * upval * uval * vval"
                                        axi_newton="- 0.5 * ma_gamma * (2 * PI * f) * (2 * PI * f) * 2 * upval * uval * r * vval" />
                <coupling:vector_form id="coupling" i="3" j="2"
                                        planar_linear="0"
                                        axi_linear="0"
					planar_newton="- 0.5 * ma_gamma * (2 * PI * f) * (2 * PI * f) * (upval * upval) * vval"
					axi_newton="- 0.5 * ma_gamma * (2 * PI * f) * (2 * PI * f) * (upval * upval) * r * vval" />
                <coupling:vector_form id="coupling" i="3" j="1"
                                        planar_linear="0"
                                        axi_linear="0"
					planar_newton="- 0.5 * ma_gamma * (2 * PI * f) * (2 * PI * f) * (upval * upval) * vval"
					axi_newton="- 0.5 * ma_gamma * (2 * PI * f) * (2 * PI * f) * (upval * upval) * r * vval" />
			</coupling:weakform_volume>

			<coupling:weakform_volume couplingtype="weak" sourceanalysis="harmonic"
				targetanalysis="transient">
                <coupling:vector_form id="coupling" i="1" j="1"
                planar_linear="0.5 * ma_gamma * (2 * PI * f)^2 * ((source1 + source3)^2 + (source2 + source4)^2) * vval"
                axi_linear="0.5 * ma_gamma * (2 * PI * f)^2 * ((source1 + source3)^2 + (source2 + source4)^2) * r * vval"
                planar_newton="- 0.5 * ma_gamma * (2 * PI * f)^2 * ((source1 + source3)^2 + (source2 + source4)^2) * vval"
                axi_newton="- 0.5 * ma_gamma * (2 * PI * f)^2 * ((source1 + source3)^2 + (source2 + source4)^2) * r * vval" />
                        </coupling:weakform_volume>

<!-- TODO: has to be altered to new harmonic module with 4 fields. i: 3->5 and there will be probably two forms instead of one (i=5, j=1) AND (i=5, j=3)-->

			<coupling:weakform_volume couplingtype="hard" sourceanalysis="harmonic"
				targetanalysis="transient">
                              <coupling:matrix_form id="coupling" i="3" j="1"
                                                        planar_linear="0"
                                                        axi_linear="0"
                                                        planar_newton="- 0.5 * ma_gamma * (2 * PI * f) * (2 * PI * f) * 2 * upval * uval * vval"
                                                        axi_newton="- 0.5 * ma_gamma * (2 * PI * f) * (2 * PI * f) * 2 * upval * uval * r * vval" />
                                <coupling:matrix_form id="coupling" i="3" j="2"
                                                        planar_linear="0"
                                                        axi_linear="0"
                                                        planar_newton="- 0.5 * ma_gamma * (2 * PI * f) * (2 * PI * f) * 2 * upval * uval * vval"
                                                        axi_newton="- 0.5 * ma_gamma * (2 * PI * f) * (2 * PI * f) * 2 * upval * uval * r * vval" />
                                <coupling:vector_form id="coupling" i="3" j="2"
                                                        planar_linear="0"
                                                        axi_linear="0"
                                                        planar_newton="- 0.5 * ma_gamma * (2 * PI * f) * (2 * PI * f) * (upval * upval) * vval"
                                                        axi_newton="- 0.5 * ma_gamma * (2 * PI * f) * (2 * PI * f) * (upval * upval) * r * vval" />
                                <coupling:vector_form id="coupling" i="3" j="1"
                                                        planar_linear="0"
                                                        axi_linear="0"
                                                        planar_newton="- 0.5 * ma_gamma * (2 * PI * f) * (2 * PI * f) * (upval * upval) * vval"
                                                        axi_newton="- 0.5 * ma_gamma * (2 * PI * f) * (2 * PI * f) * (upval * upval) * r * vval" />
                        </coupling:weakform_volume>

                        <coupling:weakform_volume couplingtype="weak" sourceanalysis="steadystate" targetanalysis="steadystate">
                                <coupling:vector_form id="coupling" i="1" j="1"
                                    planar_linear="ma_gamma * (((ma_vx - y * ma_va) * source1dx + (ma_vy + x * ma_va) * source1dy)^2) * vval"
                                    axi_linear="0"
                                    planar_newton="- ma_gamma * (((ma_vx - y * ma_va) * source1dx + (ma_vy + x * ma_va) * source1dy)^2) * vval"
                                    axi_newton="0"/>
                        </coupling:weakform_volume>

                        <coupling:weakform_volume couplingtype="weak" sourceanalysis="steadystate" targetanalysis="transient">
                                <coupling:vector_form id="coupling" i="1" j="1"
                                    planar_linear="ma_gamma * (((ma_vx - y * ma_va) * source1dx + (ma_vy + x * ma_va) * source1dy)^2) * vval"
                                    axi_linear="0"
                                    planar_newton="- ma_gamma * (((ma_vx - y * ma_va) * source1dx + (ma_vy + x * ma_va) * source1dy)^2) * vval"
                                    axi_newton="0"/>
                        </coupling:weakform_volume>

                </coupling:weakforms_volume>
	</coupling:volume>
</coupling:coupling>
